<!DOCTYPE html>
<html>
<head>
<title>Add Comments</title>
<!-- jQuery -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
<script src="/javascripts/form2js.js" type="text/javascript"></script>
<script>
$(document).ready(function(){

	//Load the events from the system
	$.getJSON("/events", function(data) {
		console.log(data);
		$.each(data, function(i, item) {
			$('#eventID').append('<option value="'+item.GID+'">' +item.GID+ '</option>');
		});
	});
});
</script>
</head>
<body>

<form id="addComment">
<table border="0">
			<tr>
				<td>Event:</td>
				<td>
					<select name="eventID" id="eventID">
					</select>
				</td>
			</tr>
			<tr>
				<td>UserID:</td>
				<td>
					<select name="userID">
						<option value="0">TODO</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>Latitude:</td>
				<td><input type="text" name="latitide" /></td>
			</tr>
			<tr>
				<td>Longitude:</td>
				<td><input type="text" name="longitude" /></td>
			</tr>
			<tr>
				<td>Comment:</td>
			</tr>
			<tr>
				<td colspan="2" align="center">
					<textarea name="text" cols="40" rows="10"></textarea>
				</td>
			</tr>
			<tr>
				<td colspan="2" align="center">
					<input type="submit" value="Submit" />
				</td>
			</tr>
		</table>
</form>

<script>
  /* attach a submit handler to the form */
  $("#addComment").submit(function(event) {
    /* stop form from submitting normally */
    event.preventDefault();  
    /* get some values from elements on the page: */
    /*
    var $form = $( this ),
        term = $form.find( 'input[name="s"]' ).val(),
        url = $form.attr( 'action' );
	*/
	var formData = form2js('addComment', '.', true);
	console.log(formData);
    /* Send the data using ajax post and put the results in a div */
	$.ajax({
		type: "POST",
		url: '/events/'+$('#eventID').val()+'/comments',
		dataType: 'json',
		data: formData,
		success: function(){
			alert('Sent!');
		},
		error: function(){
			alert('Error');
		}
	});
    
    
  });
</script>

</body>
</html>